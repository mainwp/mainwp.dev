<!DOCTYPE html>
<html lang="{{ site.dox.language }}">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{% if page.title %}{{ page.title }}{% else %}{{ site.dox.title }}{% endif %}</title>
        <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.dox.description }}{% endif %}">

        <link rel="canonical" href="{{ page.url | replace: 'index.html', '' | absolute_url }}">
        <link rel="shortcut icon" href="{{ '/favicon.ico' | absolute_url }}" type="image/x-icon">

        <!-- Theme styles -->
        <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/style.css">

        <!-- Theme scripts (deferred) -->
        <!-- Theme scripts (deferred) -->
        <script src="{{ site.baseurl }}/dox-theme/assets/js/vendor/jquery.min.js" defer></script> <!-- Keep vendor -->
        <script src="{{ site.baseurl }}/dox-theme/assets/js/vendor/highlight.pack.js" defer></script> <!-- Keep vendor -->
        <script src="{{ site.baseurl }}/dox-theme/assets/js/theme-toggle.js" defer></script> <!-- Restore -->
        <script src="{{ site.baseurl }}/dox-theme/assets/js/navigation.js" defer></script> <!-- Keep navigation.js -->
        <script src="{{ site.baseurl }}/dox-theme/assets/js/page-nav.js" defer></script> <!-- Restore -->
        <script src="{{ site.baseurl }}/dox-theme/assets/js/scripts.js" defer></script> <!-- Restore -->
    </head>
    <body>
        {% include header.html %}

        {% if page.title or page.description %}
            <div class="c-page-header">
                <div class="o-container">
                    <div class="o-row">
                        <div class="o-col-11@lg o-col-7@xl u-mx-auto@xl">
                            {% if page.title %}
                                <h1 class="c-page-header__title">{{ page.title }}</h1>
                            {% endif %}
                            {% if page.description %}
                                <div class="c-page-header__desc">
                                    <p>{{ page.description }}</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}

        <div class="c-content">
            <div class="o-container">
                <div class="o-row">
                    <div class="o-col-11@lg o-col-7@xl u-mx-auto@xl">
                        <div class="c-post">
                            {{ content }}
                            {% include comments.html classes='u-mt-8 u-mb-3' %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {% include footer.html bordered=true %}

        <!-- Initialize highlighting after defer ensures hljs is loaded -->
        <script defer>
          document.addEventListener('DOMContentLoaded', (event) => {
            // TODO: Replace deprecated call with hljs.highlightAll(); later
            if (typeof hljs !== 'undefined') {
              hljs.initHighlightingOnLoad(); 
            } else {
              console.error('Highlight.js (hljs) not loaded');
            }
          });
        </script>

        {% if site.dox.google_analytics.tracking_code and jekyll.environment == 'production' %}
            <!-- Google Analytics -->
            <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
                ga('create', '{{ site.dox.google_analytics.tracking_code }}', 'auto');
                ga('send', 'pageview');
            </script>
        {% endif %}
    </body>
</html>
